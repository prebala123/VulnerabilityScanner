# Vulnerability Scanner
This project aims to analyze the given Software Bill of Materials (SBOM) files which contain security vulnerabilities of all components of projects using AI. Each SBOM file contains information about multiple vulnerabilities which include its id, component, severity, current version, and fix version. The project feeds the SBOM files into the Chat GPT API and uses AI in order to parse and return an output which contains all of the information in a usable format. The code then outputs all of the fixable vulnerabilities along with the top 5 most severe component issues that need to be addressed. <br> <br>
The project can be run with these flags in the command line: <br>
-a [API key] <br>
-m [Chat GPT Model for "gpt-3.5-turbo" or "gpt-3.5-turbo-16k"] <br>
-b [True or False for if base images vulnerabilities should be included, default True] <br>
-j [Folder for JSON files] <br> <br>
The API key connects the API to the user's account. The model determines how many tokens are sent at one time to the API with gpt-3.5-turbo being 4,000 and gpt-3.5-turbo-16k being 16,000. The model with a larger token limit uses less API calls. For the SBOM files, some contain base images and others are derived images which are built on top of base images and contain all of their vulnerabilities plus more. If base image vulnerabilities included is True, the program outputs all vulnerabilities as they are. If it is false, it filters out all base image vulnerabilities and only includes vulnerabilities that are only in the derived images. The last flag is the folder that contains the JSON files that will be read. <br> <br>
The code first reads all of the SBOM files and separates them into base and derived images. This also matches the derived images to their base images so it is easier to filter out vulnerabilities later if -b flag is false. The SBOM files are then processed into chucks of data that fit within the API's token limit. They are then sent to ChatGPT to analyze which returns a JSON file of just the relevant information about the vulnerabilities. The the program uses the pandas module to process the JSON and clean up the resulting data to create a DataFrame containing the vulnerability's id, component, severity, current version, and fix version. The DataFrames which contain all of the data chunks across all of the SBOM files are concatenated together and are processed using ChatGPT again. The result is a list of the top 5 components with the most severe vulnerabilities that need fixing, as well as a table and JSON of all of the fixable vulnerabilities printed to the command line. <br> <br>
This program has its limitations because if uses ChatGPT to parse the data and also produce the output. Since there is a token limit to the API so the data needs to be split into multiple calls. This issue and the time spent to send API calls means that the program is slow and takes a long time for very large amounts of data. In addition, ChatGPT is not perfect and sometimes has trouble reading the data, especially when the format is too different from the expected one. However, this project is still a proof of concept for using AI as a data parser and shows that it is possible to generate detailed reports of large untabular data.
